
What needs to be improved or refactored in your Spark job:

1. class config for all filds 
2. schema with types and configurations for casting
3. csv without header (how to work with it)
4. .option("inferSchema", "true") -> false
5. change DROPMALFORMED to another options for malformed handling (save wrong lines (malformed))
6. option "overwrite" need to be chages to "append" in order to work with partitions